# coding=utf-8
import random

from ..models import result, increment, emptyMove
from ..models.enums import è¡¨åç±», æ“ä½œç±»
from ..core import database
from ..game import pokemon
from ..services import move_services, team_services
from ..models.session import ä¼šè¯ç±»
from ..dtos import å‡çº§éœ€æ±‚ç»éªŒå€¼ç®¡ç†å™¨


def å®å¯æ¢¦ç”Ÿæˆæ–¹æ³•(ä¼šè¯: ä¼šè¯ç±», ç¼–å·: str) -> result.ç»“æœç±»:
    æƒé‡ = []
    for i in range(101):
        if 45 <= i <= 55:
            æƒé‡.append(10)
        elif 35 <= i <= 65:
            æƒé‡.append(7)
        elif 25 <= i <= 75:
            æƒé‡.append(4)
        elif 10 <= i <= 90:
            æƒé‡.append(2)
        else:
            æƒé‡.append(1)

    å¤©èµ‹å€¼ = random.choices(range(101), weights=æƒé‡, k=1)[0]

    å®å¯æ¢¦æ•°æ®æ¨¡å‹ = ä¼šè¯.jsonç®¡ç†å™¨.å®å¯æ¢¦å›¾é‰´.æ ¹æ®ç¼–å·è·å–å®å¯æ¢¦(ç¼–å·)

    # è·å–åŸºç¡€æŠ€èƒ½
    æ‹›å¼åç§°åˆ—è¡¨ = move_services.åˆå§‹æ‹›å¼å­¦ä¹ æ–¹æ³•(å®å¯æ¢¦æ•°æ®æ¨¡å‹.å‡çº§å¯å­¦ä¼šæ‹›å¼åˆ—è¡¨)

    try:
        å®å¯æ¢¦ = {
            "ç¼–å·": å®å¯æ¢¦æ•°æ®æ¨¡å‹.ç¼–å·,
            "æ˜µç§°": å®å¯æ¢¦æ•°æ®æ¨¡å‹.åç§°,
            "ç»éªŒ": 0,
            "å¤©èµ‹": å¤©èµ‹å€¼,  # å®é™…ä½¿ç”¨æ—¶éœ€è¦é™¤ä»¥100, å› ä¸ºæ•°æ®åº“å­—æ®µç±»å‹æ˜¯int
            "æ€§æ ¼": ä¼šè¯.jsonç®¡ç†å™¨.æ€§æ ¼.éšæœºè¿”å›ä¸€ä¸ªæ€§æ ¼åç§°(),
            "æ€§åˆ«": random.choice(["é›„", "é›Œ"]),
            "å¿ƒæƒ…": random.randint(40, 75),
            "æ‹›å¼åç§°åˆ—è¡¨": æ‹›å¼åç§°åˆ—è¡¨,
        }
    except Exception as e:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("å®å¯æ¢¦ç”ŸæˆæœªçŸ¥é”™è¯¯: " + str(e))

    return result.ç»“æœç±».æˆåŠŸæ–¹æ³•(å®å¯æ¢¦)


async def æ³¨å†Œå®å¯æ¢¦å­˜å‚¨æ–¹æ³•(ä¼šè¯: ä¼šè¯ç±», å®å¯æ¢¦æ•°æ®: dict, æ˜¯å¦æ–°ç”¨æˆ·: bool) -> result.ç»“æœç±»:
    """
    åˆå§‹åŒ–å®å¯æ¢¦å å­˜å‚¨å…¥å„ç±»æ•°æ®åº“, ä½¿ç”¨æ‰‹åŠ¨äº‹åŠ¡ç®¡ç†ã€‚
    æ ¹æ® `æ˜¯å¦æ–°ç”¨æˆ·` æ¥åˆ¤æ–­æ˜¯æ‰§è¡Œå®Œæ•´çš„æ³¨å†Œæµç¨‹è¿˜æ˜¯ä»…ä¸ºè€ç”¨æˆ·æ·»åŠ å®å¯æ¢¦ã€‚
    """

    æ‹›å¼åç§°åˆ—è¡¨ = å®å¯æ¢¦æ•°æ®.pop("æ‹›å¼åç§°åˆ—è¡¨")

    if æ˜¯å¦æ–°ç”¨æˆ·:
        # å¯¹äºæ–°ç”¨æˆ·ï¼Œéœ€è¦æ’å…¥ç”¨æˆ·ã€é˜Ÿä¼ã€å®å¯æ¢¦ã€æ‹›å¼ã€é˜Ÿä¼æˆå‘˜çš„å®Œæ•´ä¿¡æ¯
        æ•°æ®åº“æ“ä½œåˆ—è¡¨ = [
            {
                "è¡¨å": è¡¨åç±».å®å¯æ¢¦è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": å®å¯æ¢¦æ•°æ®
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».åˆ é™¤,
                'æ¡ä»¶': {'å®å¯æ¢¦ID': ("ç´¢å¼•", 0)}  # ("ç´¢å¼•", 0) æŒ‡å‘ç¬¬ä¸€ä¸ªæ“ä½œæ’å…¥çš„å®å¯æ¢¦ID
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».æ’å…¥,
                'æ•°æ®': [{"å®å¯æ¢¦ID": ("ç´¢å¼•", 0), "æ‹›å¼åç§°": i} for i in æ‹›å¼åç§°åˆ—è¡¨]
            },
            {
                "è¡¨å": è¡¨åç±».é˜Ÿä¼ä¿¡æ¯è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": {
                    "ç”¨æˆ·ID": ä¼šè¯.ç”¨æˆ·qq,
                    "é˜Ÿä¼åºå·": 1,
                    "é˜Ÿä¼åç§°": "å¯ç¨‹ä¹‹é˜Ÿ"
                }
            },
            {
                "è¡¨å": è¡¨åç±».é˜Ÿä¼æˆå‘˜è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": {
                    "é˜Ÿä¼ID": ("ç´¢å¼•", 3),  # ("ç´¢å¼•", 3) æŒ‡å‘ç¬¬å››ä¸ªæ“ä½œæ’å…¥çš„é˜Ÿä¼ID
                    "å®å¯æ¢¦ID": ("ç´¢å¼•", 0),
                    "ä½ç½®ç´¢å¼•": 0
                }
            },
            {
                "è¡¨å": è¡¨åç±».ç”¨æˆ·è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": {
                    "ç”¨æˆ·ID": ä¼šè¯.ç”¨æˆ·qq,
                    "é‡‘é’±": ä¼šè¯.åˆå§‹é‡‘é’±æ•°,
                    "å½“å‰é˜Ÿä¼ID": ("ç´¢å¼•", 3),
                }
            },
        ]
        æˆåŠŸæ¶ˆæ¯ = f"ğŸŒ„ æ–°çš„æ—…ç¨‹ç”±æ­¤å±•å¼€ï¼ä¸{å®å¯æ¢¦æ•°æ®['æ˜µç§°']}ä¸€åŒè¸ä¸Šå¾é€”å§\nè¾“å…¥ã€Œ/pm å¸®åŠ©ã€å¯æŸ¥çœ‹æŒ‡ä»¤ä¿¡æ¯"

    else:
        # å¯¹äºå®å¯æ¢¦ä¸¢å¤±çš„è€ç”¨æˆ·ï¼Œé¦–å…ˆè·å–å…¶å½“å‰çš„é˜Ÿä¼ID
        ç»“æœ = await team_services.è·å–å½“å‰é˜Ÿä¼IDæ–¹æ³•(ä¼šè¯.ç”¨æˆ·qq)

        if not ç»“æœ.æ˜¯å¦æˆåŠŸ:
            return ç»“æœ.å¤±è´¥æ–¹æ³•(f"ä¸ºè€ç”¨æˆ·æ·»åŠ å®å¯æ¢¦æ—¶å‡ºé”™ï¼š{ç»“æœ.é”™è¯¯ä¿¡æ¯}")

        é˜Ÿä¼ID = ç»“æœ.æ•°æ®ä¿¡æ¯

        # ä»…éœ€è¦æ’å…¥å®å¯æ¢¦ã€æ‹›å¼ï¼Œå¹¶å°†å…¶åŠ å…¥åˆ°å·²å­˜åœ¨çš„é˜Ÿä¼ä¸­
        æ•°æ®åº“æ“ä½œåˆ—è¡¨ = [
            {
                "è¡¨å": è¡¨åç±».å®å¯æ¢¦è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": å®å¯æ¢¦æ•°æ®
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».åˆ é™¤,
                'æ¡ä»¶': {'å®å¯æ¢¦ID': ("ç´¢å¼•", 0)}
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».æ’å…¥,
                'æ•°æ®': [{"å®å¯æ¢¦ID": ("ç´¢å¼•", 0), "æ‹›å¼åç§°": i} for i in æ‹›å¼åç§°åˆ—è¡¨]
            },
            {
                "è¡¨å": è¡¨åç±».é˜Ÿä¼æˆå‘˜è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": {
                    "é˜Ÿä¼ID": é˜Ÿä¼ID,  # ä½¿ç”¨å·²è·å–çš„é˜Ÿä¼ID
                    "å®å¯æ¢¦ID": ("ç´¢å¼•", 0),
                    "ä½ç½®ç´¢å¼•": 0  # é»˜è®¤æ”¾å…¥é˜Ÿä¼çš„ç¬¬ä¸€ä¸ªä½ç½®
                }
            }
        ]
        æˆåŠŸæ¶ˆæ¯ = f"ğŸ¤ æ¬¢è¿å›æ¥ï¼Œè®­ç»ƒå®¶ï¼{å®å¯æ¢¦æ•°æ®['æ˜µç§°']}åŠ å…¥äº†ä½ çš„é˜Ÿä¼ï¼Œæˆä¸ºä½ æ–°çš„ä¼™ä¼´ï¼"

    db = await database.è·å–æ•°æ®åº“å¯¹è±¡()
    ç»“æœ = await db.å†™å…¥æ–¹æ³•(æ•°æ®åº“æ“ä½œåˆ—è¡¨)

    if ç»“æœ.æ˜¯å¦æˆåŠŸ:
        return result.ç»“æœç±».æˆåŠŸæ–¹æ³•(æˆåŠŸæ¶ˆæ¯)
    else:
        return ç»“æœ


async def æ–°å»ºå®å¯æ¢¦é˜Ÿä¼æ–¹æ³•(
    ä¼šè¯,
    é˜Ÿä¼åç§°: str,
    ç”¨æˆ·èƒŒåŒ…å¯¹è±¡,
) -> result.ç»“æœç±»:
    # åˆ¤æ–­ç”¨æˆ·æœ‰å‡ ä¸ªé˜Ÿä¼
    db = await database.è·å–æ•°æ®åº“å¯¹è±¡()

    ç»“æœ = await db.å•æ¬¡æŸ¥è¯¢æ–¹æ³•(
        {
            "è¡¨å": è¡¨åç±».é˜Ÿä¼ä¿¡æ¯è¡¨,
            "æŸ¥è¯¢æ•°æ®": ['é˜Ÿä¼ID', 'é˜Ÿä¼åºå·', 'é˜Ÿä¼åç§°'],
            "æ¡ä»¶": {
                "ç”¨æˆ·ID": ä¼šè¯.ç”¨æˆ·qq
            }
        }
    )

    if not ç»“æœ.æ˜¯å¦æˆåŠŸ:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("é˜Ÿä¼æŸ¥è¯¢å¤±è´¥äº†")

    é˜Ÿä¼åˆ—è¡¨ = ç»“æœ.æ•°æ®ä¿¡æ¯

    if é˜Ÿä¼åˆ—è¡¨:
        é˜Ÿä¼åºå· = é˜Ÿä¼åˆ—è¡¨[-1]["é˜Ÿä¼åºå·"] + 1
    else:
        é˜Ÿä¼åºå· = 1

    é˜Ÿä¼ä¸Šé™ = ä¼šè¯.åˆå§‹æœ€å¤§é˜Ÿä¼ä¸Šé™ + ç”¨æˆ·èƒŒåŒ…å¯¹è±¡.è¿”å›é˜Ÿä¼ä¸Šé™ä¿®æ­£å€¼æ–¹æ³•()

    if len(é˜Ÿä¼åˆ—è¡¨) > é˜Ÿä¼ä¸Šé™ - 1:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•(f"ä¸è¡Œå“¦, ç›®å‰ä½ çš„å®¶åªèƒ½æ”¾ä¸‹{é˜Ÿä¼ä¸Šé™}åªé˜Ÿä¼, å¯ä»¥ä½¿ç”¨`/pm å•†åº—`è´­ä¹°æˆ¿äº§å“¦")

    # åˆ¤æ–­é˜Ÿä¼æ˜¯å¦é‡å
    for i in é˜Ÿä¼åˆ—è¡¨:
        if é˜Ÿä¼åç§° == i["é˜Ÿä¼åç§°"]:
            return result.ç»“æœç±».å¤±è´¥æ–¹æ³•(f"ç­‰ä¸€ä¸‹, è¿™ä¹ˆåå­—å’Œä½ çš„ç¬¬{i['é˜Ÿä¼åºå·']}åªé˜Ÿä¼é‡åäº†, æ¢ä¸€ä¸ªåç§°å§")

    # åˆ›å»ºæ–°é˜Ÿä¼
    ç»“æœ = await db.å†™å…¥æ–¹æ³•([
        {
            "è¡¨å": è¡¨åç±».é˜Ÿä¼ä¿¡æ¯è¡¨,
            "æ“ä½œ": æ“ä½œç±».æ’å…¥,
            "æ•°æ®": {"ç”¨æˆ·ID": ä¼šè¯.ç”¨æˆ·qq, "é˜Ÿä¼åºå·": é˜Ÿä¼åºå·, "é˜Ÿä¼åç§°": é˜Ÿä¼åç§°},
        }
    ])

    if ç»“æœ.æ˜¯å¦æˆåŠŸ:
        return result.ç»“æœç±».æˆåŠŸæ–¹æ³•(f"{é˜Ÿä¼åç§°} é˜Ÿä¼åˆ›å»ºæˆåŠŸ! è¿™æ˜¯ä½ çš„ç¬¬{len(é˜Ÿä¼åˆ—è¡¨) + 1}ä¸ªé˜Ÿä¼å“¦")
    else:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("é˜Ÿä¼æŸ¥è¯¢å¤±è´¥äº†")


async def å®å¯æ¢¦æ·»åŠ æ–¹æ³•(ç”¨æˆ·ID: int, å®å¯æ¢¦æ•°æ®: dict):
    """
    æ·»åŠ å®å¯æ¢¦åˆ°æŒ‡å®šé˜Ÿä¼çš„æŒ‡å®šä½ç½® !
    """
    db = await database.è·å–æ•°æ®åº“å¯¹è±¡()

    ç»“æœ = await db.å•æ¬¡æŸ¥è¯¢æ–¹æ³•(
        {
            "è¡¨å": è¡¨åç±».å®å¯æ¢¦è¡¨,
            "æŸ¥è¯¢æ•°æ®": "ç›’å­åºå·",
            "æ¡ä»¶": {
                "ç”¨æˆ·ID": ç”¨æˆ·ID
            }
        }
    )

    if not ç»“æœ.æ˜¯å¦æˆåŠŸ:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("é˜Ÿä¼æŸ¥è¯¢å¤±è´¥äº†")

    try:
        æœ€å¤§åºå· = max([i if i else -1 for i in ç»“æœ.æ•°æ®ä¿¡æ¯])
        å®å¯æ¢¦æ•°æ®["ç›’å­åºå·"] = max(æœ€å¤§åºå· + 1, 1)

        æ‹›å¼åç§°åˆ—è¡¨ = å®å¯æ¢¦æ•°æ®.pop("æ‹›å¼åç§°åˆ—è¡¨")

        ç»“æœ = await db.å†™å…¥æ–¹æ³•([
            {
                "è¡¨å": è¡¨åç±».å®å¯æ¢¦è¡¨,
                "æ“ä½œ": æ“ä½œç±».æ’å…¥,
                "æ•°æ®": å®å¯æ¢¦æ•°æ®
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».åˆ é™¤,
                'æ¡ä»¶': {'å®å¯æ¢¦ID': ("ç´¢å¼•", 0)}
            },
            {
                'è¡¨å': è¡¨åç±».æ‹›å¼è¡¨,
                'æ“ä½œ': æ“ä½œç±».æ’å…¥,
                'æ•°æ®': [{"å®å¯æ¢¦ID": ("ç´¢å¼•", 0), "æ‹›å¼åç§°": i} for i in æ‹›å¼åç§°åˆ—è¡¨]
            }
        ])

        if not ç»“æœ.æ˜¯å¦æˆåŠŸ:
            return ç»“æœ.å¤±è´¥æ–¹æ³•("å®å¯æ¢¦æ·»åŠ å¤±è´¥äº†")

    except Exception as e:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("æœªçŸ¥é”™è¯¯: " + str(e))

    return result.ç»“æœç±».æˆåŠŸæ–¹æ³•("")


def è¿”å›å®å¯æ¢¦ç­‰çº§æ–¹æ³•(ä¼šè¯: ä¼šè¯ç±», ç»éªŒ: int, æˆé•¿é€Ÿåº¦: str) -> int:
    return ä¼šè¯.jsonç®¡ç†å™¨.å‡çº§éœ€æ±‚ç»éªŒå€¼.æ ¹æ®ç»éªŒå€¼è·å–ç­‰çº§(ç»éªŒ, æˆé•¿é€Ÿåº¦)


def è¿”å›åˆ°è¾¾æŒ‡å®šç­‰çº§çš„æ‰€éœ€ç»éªŒå€¼æ–¹æ³•(ç®¡ç†å™¨: å‡çº§éœ€æ±‚ç»éªŒå€¼ç®¡ç†å™¨, ç­‰çº§: int, æˆé•¿é€Ÿåº¦: str) -> int:
    æ‰€éœ€ç»éªŒ = ç®¡ç†å™¨.è·å–åˆ°è¾¾ç­‰çº§æ‰€éœ€ç»éªŒ(ç­‰çº§, æˆé•¿é€Ÿåº¦)

    if æ‰€éœ€ç»éªŒ is None:
        return 0
    return æ‰€éœ€ç»éªŒ

def è¿”å›å¤©èµ‹å€¼å¯¹åº”æè¿°æ–‡æœ¬(å¤©èµ‹: int) -> str:
    if å¤©èµ‹ >= 95:
        return "æœ€æ£’"
    elif å¤©èµ‹ >= 85:
        return "äº†ä¸èµ·"
    elif å¤©èµ‹ >= 70:
        return "éå¸¸å¥½"
    elif å¤©èµ‹ >= 50:
        return "ç›¸å½“å¥½"
    elif å¤©èµ‹ >= 30:
        return "ä¸€èˆ¬èˆ¬"
    else:
        return "ä¹Ÿè®¸ä¸è¡Œ"


def è¿”å›å¤©èµ‹å€¼å¯¹åº”å€ç‡(å¤©èµ‹: int) -> float:
    if å¤©èµ‹ >= 95:
        return 1.20  # æœ€æ£’ï¼š20% å±æ€§åŠ æˆ
    elif å¤©èµ‹ >= 85:
        return 1.15  # äº†ä¸èµ·ï¼š15% å±æ€§åŠ æˆ
    elif å¤©èµ‹ >= 70:
        return 1.10  # éå¸¸å¥½ï¼š10% å±æ€§åŠ æˆ
    elif å¤©èµ‹ >= 50:
        return 1.00  # ç›¸å½“å¥½/å¹³å‡æ°´å¹³ï¼šæ— åŠ æˆä¹Ÿæ— æƒ©ç½šï¼Œä½œä¸ºåŸºå‡†
    elif å¤©èµ‹ >= 30:
        return 0.90  # ä¸€èˆ¬èˆ¬ï¼š10% å±æ€§æƒ©ç½š
    else:  # å¤©èµ‹å°äº30
        return 0.80


async def é˜Ÿä¼æ‰¹é‡è½¬å®å¯æ¢¦å¯¹è±¡æ–¹æ³•(ä¼šè¯: ä¼šè¯ç±», å®å¯æ¢¦ä¿¡æ¯åˆ—è¡¨: list) -> result.ç»“æœç±»:
    å¯¹è±¡åˆ—è¡¨ = []
    try:
        for æ•°æ®ä¿¡æ¯ in å®å¯æ¢¦ä¿¡æ¯åˆ—è¡¨:
            æ‹›å¼åˆ—è¡¨ = await move_services.è¿”å›æ‹›å¼æ•°æ®æ–¹æ³•(æ•°æ®ä¿¡æ¯["ä¸»é”®ID"], ä¼šè¯)

            å¯¹è±¡åˆ—è¡¨.append(
                pokemon.å®å¯æ¢¦ç±»(
                    ä¼šè¯,
                    å®å¯æ¢¦æ•°æ®å­—å…¸=æ•°æ®ä¿¡æ¯,
                    å®å¯æ¢¦å›¾é‰´ä¿¡æ¯=ä¼šè¯.jsonç®¡ç†å™¨.å®å¯æ¢¦å›¾é‰´.æ ¹æ®ç¼–å·è·å–å®å¯æ¢¦(æ•°æ®ä¿¡æ¯['ç¼–å·']),
                    æ‹›å¼åˆ—è¡¨=æ‹›å¼åˆ—è¡¨
                )
            )
    except Exception as e:
        return result.ç»“æœç±».å¤±è´¥æ–¹æ³•("å®å¯æ¢¦ç±»å®ä¾‹åŒ–å¤±è´¥: " + str(e))

    return result.ç»“æœç±».æˆåŠŸæ–¹æ³•(å¯¹è±¡åˆ—è¡¨)


def è¿”å›å€ç‡å½±å“åçš„å±æ€§æ–¹æ³•(
    å½“å‰å±æ€§å­—å…¸: dict,
    å€ç‡å­—å…¸: dict,
    å®å¯æ¢¦å±æ€§åˆ—è¡¨: list,
    å¤©æ°”å±æ€§å€ç‡å­—å…¸: dict,
    megaæ˜¯å¦å¼€å¯: bool
) -> dict:
    å±æ€§ä¿®æ­£ = {
        k: int(v * å€ç‡å­—å…¸.get(k, 1.0))
        for k, v in å½“å‰å±æ€§å­—å…¸.items()
    }

    if megaæ˜¯å¦å¼€å¯:
        å±æ€§ä¿®æ­£ = {
            k: int(v * 1.4)
            for k, v in å±æ€§ä¿®æ­£.items()
        }

    # è®¡ç®—å¤©æ°”å¯¹è¿™åªå®å¯æ¢¦çš„æœ€ç»ˆå€ç‡
    å¤©æ°”å€ç‡åˆ—è¡¨ = [å¤©æ°”å±æ€§å€ç‡å­—å…¸.get(attr, 1.0) for attr in å®å¯æ¢¦å±æ€§åˆ—è¡¨]
    if len(å¤©æ°”å€ç‡åˆ—è¡¨) == 1:
        å¤©æ°”æœ€ç»ˆå€ç‡ = å¤©æ°”å€ç‡åˆ—è¡¨[0]
    else:  # åŒå±æ€§
        å¤©æ°”æœ€ç»ˆå€ç‡ = 1.0 + sum(m - 1 for m in å¤©æ°”å€ç‡åˆ—è¡¨)

    # åº”ç”¨å¤©æ°”å€ç‡
    ç»“æœå­—å…¸ = {
        k: int(v * å¤©æ°”æœ€ç»ˆå€ç‡)
        for k, v in å±æ€§ä¿®æ­£.items()
    }

    if ç»“æœå­—å…¸ and len(ç»“æœå­—å…¸) == 6:
        return ç»“æœå­—å…¸
    return å½“å‰å±æ€§å­—å…¸
