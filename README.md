## 项目状态
**当前版本**: v0.5.5-test  
**下一个版本**: v0.6.0-alpha: Pydantic彻底完成迁移  多分支进化


暂时ok 不要忘了将所有宝可梦贴图改成左朝向
暂时ok 若进化有多方向, 则不执行进化, 而是返回文案进行提示

bug记录
==========
当用户没有领养, 管理员强制添加宝可梦会报错


==========


进化道具 新增 对应的效果代码
同时可以新增辅助的指令, 如查看可进化宝可梦, 批量进化(有风险)之类的

新增道具:
经验糖果 可能需要修改现有的方法来适配

男溺泉, 娘溺泉  修改性别, 指定默认队伍的宝可梦

天赋值增加道具, 或者直接改成最大天赋值

金钱礼包类, 考虑到使用指令的麻烦程度,金钱最小值应该比较高
也可以基于礼包的不同等级设置随机范围

蛋 星级不一致, 可以孵化出不同稀有度的1级宝可梦到盒子里, 需要新增专用指令: 孵蛋

进化石类 需要新增专用指令: 进化, 查看可进化的宝可梦或者自动消耗进化石等等, 比较复杂

钥匙类, 自带一个场景或剧情提示词, 用于冒险指令, 生成对应剧情和对应稀有度的宝可梦战斗

-------------


修改宝可梦图鉴, 14个多进化方向的, 添加升级道具
如/pm 使用 xx进化石 序号
基于当前使用队伍的位置序号进行定位


新增指令:
查看可以进化的宝可梦, 返回进化信息, 进化条件, 最后是操作提示

构建轻量级的声明式UI布局系统

可以考虑创建六维属性枚举类

battle.py 中的 TYPE_CHART（属性克制表）可改成json

新增 别名, 对常用的任务, 运行使用简短别名, 如 /pm 冒险 = /冒险
也可以考虑配置项中开启更简短别名: /mx

新功能思考
===========
无对战情况下获取经验值, 防止谁也打不过的情况

===========


数值修改
=========
对战获取的经验值有点太多了

=========




开发路线图 (Roadmap)
建议将开发分为三个阶段，循序渐进，确保每个版本都有稳定和有意义的更新。
第一阶段：核心体验优化 & QoL (Quality of Life)
此阶段专注于完善现有功能，提升玩家的直接体验。
1. 信息透明化 (玩家最急需)
指令：/pm 详情 [序号] - 查看队伍中单只宝可梦的完整数据（属性、天赋、性格、技能等）。
指令：/pm 图鉴 [名称/编号] - 查看指定宝可梦的官方图鉴信息。
指令：/pm 进化列表 - 显示当前队伍或盒子中所有满足进化条件的宝可梦及其进化路径和方式。
2. 道具系统补全 (丰富玩法)
实装简单效果道具：
经验糖果：修改 item_effects.py，实现给予宝可梦经验的效果。
金钱/特殊礼包：实现开启后获得金钱或随机道具的功能。
性别转换道具：如“男溺泉”、“娘溺泉”。
天赋提升道具：可设计为提升至上限或增加固定值。
商店更新：将以上新道具加入商店。
3. 基础代码重构 (技术债清理)
属性克制表JSON化：将 battle.py 中的 TYPE_CHART 移至JSON文件，由 json_manager 统一管理。
创建属性枚举类：将"攻击", "防御"等字符串替换为 enums.Stats.ATTACK 这样的枚举，提高代码健壮性。
第二阶段：新系统引入 & 玩法拓展
此阶段引入全新的游戏模块，增加游戏深度。
1. 进化石系统 (核心玩法扩展)
道具效果：在 item_effects 中添加对进化石类道具的支持。
配套指令：实现 /pm 进化 [宝可梦序号] [道具名称]，消耗背包中的进化石来使特定宝可梦进化。
图鉴数据：为14只多形态进化的宝可梦在 宝可梦图鉴.json 中添加道具进化路径。
2. 竞技与社交系统 (提升玩家互动)
战斗积分 (Elo)：在对战结束后，根据胜负和双方积分差异，更新玩家的战斗积分。
排行榜系统：
指令：/pm 排行榜 [类型] - 查看各类排行榜。
榜单类型：
战斗积分榜 (可分为 全服总榜 和 群内排行榜)。
金钱榜。
宝可梦总等级/数量榜。
图鉴完成度榜。
3. 宝可梦获取渠道扩展
蛋孵化系统：
商店上架不同稀有度的“宝可梦的蛋”。
购买后进入孵化列表，需要一定时间孵化。
指令：/pm 孵化 - 查看孵化进度，并在完成后获得一只1级的随机宝可梦。
4. 便利性功能
指令别名：在机器人配置或代码中，增加别名映射，如 /冒险 -> /pm 冒险，提升常用指令的便利性。
第三阶段：高级功能 & 未来展望
此阶段专注于实现复杂、创新且能带来巨大吸引力的功能。
1. 抽奖系统 (Gacha)
设计不同主题的奖池（如属性奖池、传说宝可梦奖池）。
利用 Pillow/imageio 库实现动态GIF抽卡动画，在最后几帧揭晓奖励，提升仪式感。
设计合理的概率和保底机制。
2. LLM 整合 (AI驱动的动态内容)
作为可选项：在配置中允许开启或关闭LLM功能，关闭时回退到现有的随机文案系统。
第一步：/pm 玩耍 - 场景可控，风险较低。结合宝可梦性格和用户输入的简单地点，生成一段互动故事，并结构化地返回奖励（经验、心情）。
第二步：/pm 冒险 - 结合地点、天气、携带的特殊道具（如“钥匙”）生成动态的冒险场景和敌人。
重点：严格的防提示词注入机制和结构化数据返回是成功的关键。
3. 趣味性扩展
宝可梦融合：集成开源的宝可梦融合素材库，实现一个纯娱乐性的图片生成功能。
三、架构与技术改进建议
1. 代码风格 - 逐步英文化
建议：新编写的模块和变量名开始使用英文。无需花费大量精力重构所有现有代码，保持模块内的一致性即可。这有利于未来协作和使用各类开发工具。
2. 项目结构优化
main.py 轻量化：将其职责限定为“指令分发器”，只负责接收指令、创建会话对象、调用Handler，然后发送结果。所有业务逻辑都应在 Service 层处理。
文件夹重组：考虑将 dtos (Pydantic模型) 和 schema (ORM模型) 统一归入 models 文件夹下的不同子目录，使模型定义更集中。
3. 图片渲染 - 告别硬编码坐标
核心思想：从“手动计算 (x, y)”转向“声明式布局”。
实现路径：创建一个简单的布局系统，包含 VStack (垂直堆叠)、HStack (水平堆叠)、Text、Image 等组件。编写一个渲染器，将这些声明式组件递归地转换为最终带有绝对坐标的渲染指令列表。
收益：一旦完成，未来新增或修改任何图片界面将变得极其简单、快速且不易出错。
四、新增功能点与平衡性考量
1. 新手体验优化
新手保护：在PVP匹配时，加入等级或积分限制，防止新手被高级玩家碾压。
防止破产：可以设计一个简单的 /pm 签到 指令，每日提供少量金钱，作为基础保障。
慢速训练 (挂机)：提供一个挂机训练的指令，时间较长，经验获取效率随时间衰减或有每日上限。为不想频繁战斗的玩家提供另一种成长路径。
2. 游戏机制与数值
对战冷却：为PVP对战增加一个冷却时间（例如5分钟），防止恶意刷屏或滥用。
持续数值调整：这是一个长期任务。根据玩家反馈，持续调整经验曲线、金钱奖励、道具价格、战斗伤害公式等，以保持游戏平衡和趣味性。