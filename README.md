
---

# AstrBot 宝可梦插件开发企划书

**当前版本**: `v0.5.5-test`  
**下一版本目标**: `v0.6.0-alpha`  
**核心目标**: **完善核心体验 & 稳固基础架构**。此版本将专注于补全现有系统的核心功能、优化玩家最常接触的体验，并进行必要的代码重构，为后续引入更复杂的系统打下坚实的基础。

---

## **第一阶段：核心体验 & 基础架构**

### **游戏逻辑与规则引擎**
引入一个独立的中央逻辑处理模块（例如 `game/rules.py`）。该模块将用于集中管理游戏内的核心规则判断，如PVP对战冷却、道具效果对规则的动态影响等。它将通过实时查询数据库来应用规则，以适应协程环境下的数据持久化需求。

### **信息透明化**
- **`/pm 详情` 指令**: 实现查看单只宝可梦的完整数据（属性、天赋、技能等）。
- **`/pm 图鉴` 指令**: 查看指定宝可梦的官方图鉴信息与进化链。
- **`/pm 进化列表` 指令**: 显示当前所有满足进化条件的宝可梦及其进化方式。

### **道具系统补全**
优先在 `item_effects.py` 中实装经验糖果、性别转换、天赋值提升和金钱礼包等基础道具的核心效果，并同步更新商店。

### **Bug修复与稳定性**
- **数据库初始化**: 确保数据库初始化逻辑在插件首次加载时能被正确触发。
- **战斗回合数上限**: 为战斗系统增加回合数上限，防止因无限循环导致的报错。
- **管理员指令修复**: 修复管理员为未注册用户强制添加宝可梦时发生的错误。
- **数值平衡**: 初步调整对战获取的经验值，平滑早期成长曲线。

### **基础代码重构**
- **属性克制表JSON化**: 将硬编码在 `battle.py` 中的属性克制表移至独立的JSON文件。
- **引入枚举类**: 为六维属性等常量创建枚举类，替换代码中的“魔法字符串”。

## **第二阶段：新系统引入 & 玩法拓展**

### **特殊进化系统**
实现使用进化石等道具进行进化的完整流程，并开发配套的 `/pm 进化` 指令。同时，在图鉴数据中为相关宝可梦添加道具进化路径。

### **竞技与社交系统**
- **战斗积分 (Elo)**: 在对战结算时，为玩家增减Elo积分。
- **排行榜**: 实现 `/pm 排行榜` 指令，可查看战斗积分榜、金钱榜、图鉴完成度榜等。

### **宝可梦获取渠道扩展**
引入蛋孵化系统。玩家可在商店购买不同稀有度的“宝可梦的蛋”，通过 `/pm 孵化` 指令查看进度并在完成后获得新宝可梦。

### **便利性功能**
- **指令别名**: 支持配置简单的指令别名，如 `/冒险` 映射到 `/pm 冒险`。
- **新手体验**: 增加 `/pm 签到` 或 `/pm 训练` 等指令，为新手玩家提供基础保障和追赶机制。

## **第三阶段：高级功能 & 未来展望**

### **抽奖系统 (Gacha)**
设计不同主题的奖池，并引入用于抽奖的“高级货币”。利用Pillow/imageio库，实现可动态生成奖励结果的GIF抽卡动画，提升仪式感。

### **LLM 整合 (可选模块)**
作为可选项在配置中开启，关闭时回退到现有的随机文案系统。
- **`/pm 玩耍`**: 结合宝可梦性格与用户输入，通过防注入的提示词模板生成互动故事和奖励。
- **`/pm 冒险`**: 结合地点、天气和特殊道具，动态生成冒险场景与敌人。

### **娱乐性扩展**
- **宝可梦融合**: 集成开源的宝可梦融合素材库，实现一个纯娱乐性的图片生成功能。
- **管理员后台**: 开发一个简单的Web后台，方便管理员查看数据和管理玩家。