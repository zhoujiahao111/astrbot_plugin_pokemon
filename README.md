

---

# AstrBot 宝可梦插件开发路线图

**当前版本**: `v0.5.5-test`  
**下一版本目标**: `v0.6.0-alpha`  
**核心目标**: **完善核心体验 & 稳固基础架构**。此版本将专注于补全现有系统的核心功能、优化玩家最常接触的体验，并进行必要的代码重构，为后续引入更复杂的系统打下坚实的基础。

---

## **第一阶段：地基与核心体验 (v0.6.0)**

*此阶段的目标是让现有游戏变得稳定、易用且核心玩法完整，是所有后续功能的基础。*

### **核心架构与规则引擎**
*   **中央规则引擎**: 引入独立的中央逻辑处理模块 (例如 `game/rules.py`)，集中管理游戏内的核心规则判断，如指令冷却、道具效果的动态影响等，并实时查询数据库以应用规则，解决无状态协程环境下的持久化问题。
*   **标准化输出**: 创建专用的输出封装函数/类，统一处理图文混合、合并转发等复杂响应，确保输出格式统一且易于维护。
*   **代码重构**:
    *   将硬编码在 `battle.py` 中的属性克制表移至独立的JSON文件。
    *   为六维属性等常量创建枚举类，替换代码中的“魔法字符串”，提升代码健壮性。
### **底层架构优化**
*   **图片渲染引擎重构**: 对 `image_utils.py` 和 `image_data_services.py` 进行大规模优化，采用卡片式渲染

### **核心系统补全**
*   **道具系统**: 在 `item_effects.py` 中实装经验糖果、性别转换、天赋值提升等基础道具的核心效果。为所有可堆叠道具设置99的堆叠上限。
*   **信息透明化**:
    *   完成 `/pm 详情` 指令，用于查看单只宝可梦的详细信息。
    *   完成 `/pm 图鉴` 指令，用于查询指定宝可梦的图鉴信息。
    *   完成 `/pm 进化列表` 指令，方便玩家查询进化路径。



### **用户交互与易用性**
*   **帮助与引导**: 创建全面的 `/pm 帮助` 指令，并实现一个正则匹配接收器，用于捕获不存在的pm指令，向用户提示拼写错误并推荐最接近的正确指令。
*   **指令别名**: 增加别名配置功能，允许将常用指令（如 `/冒险`）映射到标准指令（`/pm 冒险`）。

### **Bug修复与稳定性**
*   **数据库初始化**: 确保数据库初始化逻辑在插件首次加载时能被正确触发。
*   **战斗回合数上限**: 为战斗系统增加回合数上限，防止因无限循环导致的报错。
*   **管理员指令修复**: 修复管理员为未注册用户强制添加宝可梦时发生的错误。
*   **背包显示**: 修复背包中消耗后数量为0的道具仍然显示的问题。
*   **数值平衡**: 初步调整对战获取的经验值，平滑早期成长曲线。

---

## **第二阶段：玩法拓展与目标驱动 (v0.7.0)**

*此阶段专注于为玩家提供明确的游戏目标和更丰富的玩法，提升玩家的留存率和参与度。*

### **PVE核心玩法**
*   **道馆挑战**: 设计至少8个道馆，每个道馆拥有固定阵容的强大“馆主”。挑战成功后，玩家可获得对应的徽章及金钱/道具奖励。

### **玩家成长与个性化**
*   **玩家状态面板**: 实现 `/pm 状态` (或 `/pm 面板`) 指令，展示玩家的统计信息，如总战斗次数、胜率、捕获宝可梦总数、图鉴进度等。可考虑与 `/pm 队伍` 指令整合。
*   **成就与称号系统**:
    *   设计一套成就体系 (如“首次战胜馆主”、“捕捉100只宝可梦”)，并设计相应的数据库查询逻辑。
    *   玩家达成特定条件后可以解锁并装备称号，显示在玩家信息面板上。

### **经济与资源循环**
*   **高级货币系统**: 引入“钻石”或“点券”等高级货币，用于抽奖、特殊商店等消耗。
*   **离线收益**: 实现 `/pm 挂机` 或 `/pm 探索` 指令，玩家启动后，再次使用指令时可结算离线收益 (少量经验和金钱)，收益有时间上限 (如24小时)，作为回归奖励。
*   **图鉴进度奖励**: 根据玩家捕获宝可梦的种类数量，在特定节点 (如50种、100种) 给予一次性奖励。

---

## **第三阶段：深度与社交 (v0.8.0)**

*此阶段引入更复杂的系统和玩家间的互动，增加游戏的长期可玩性和社区粘性。*

### **竞技与社交**
*   **战斗积分 (Elo) 与排行榜**:
    *   在PVP对战结算时增减Elo积分。
    *   实现 `/pm 排行榜` 指令，可查看战斗积分、金钱、图鉴完成度等榜单。
*   **单人PVE大赛**: 设计类似“宝可梦联盟”的连续挑战赛，玩家需用一支队伍连续战胜多个强大的训练家，赢取丰厚奖励。

### **宝可梦获取渠道扩展**
*   **特殊进化系统**: 实现使用进化石等道具进行进化的完整流程，并开发配套的 `/pm 进化` 指令。
*   **蛋孵化系统**:
    *   玩家可通过商店或特殊活动获得“宝可梦的蛋”。
    *   购买后自动添加至孵化列表，通过 `/pm 孵化` 指令查看进度，并在完成后获得新宝可梦。

### **抽奖系统 (Gacha)**
*   **卡池设计**: 设计不同主题的奖池，包含稀有宝可梦、道具等。
*   **抽卡指令**: 实现 `/pm 抽奖` 和 `/pm 十连抽` 指令。
*   **卡池查看**: 实现 `/pm 卡池` 指令，以图片形式展示当前卡池内容。
*   **抽卡动画**: 利用Pillow/imageio库，实现可动态生成奖励结果的GIF抽卡动画，模板预先生成，仅最后几帧动态修改以保证性能。

---

## **第四阶段：未来展望与高级功能 (v0.9.0+)**

*此阶段包含高复杂度、高吸引力的功能，将在项目成熟后择机实现。*

### **高级系统**
*   **装备系统**:
    *   允许用户装备道具以获得属性加成或特殊效果。
    *   开发装备的出售、升级和锻造系统。
*   **地区设置**: 允许用户设置不同难度的地区，影响冒险文案、战斗难度和遇到的宝可梦类型。
*   **LLM 整合 (可选模块)**:
    *   作为可选项在配置中开启，未开启时使用随机文案。
    *   实现 `/pm 玩耍` (生成互动故事) 和 `/pm 冒险` (动态生成冒险场景) 等AI驱动的功能。
    *   设计完善的提示词模板和防注入机制。

### **娱乐与管理**
*   **宝可梦融合**: 集成开源的宝可梦融合素材库，实现一个纯娱乐性的图片生成功能。
*   **管理员后台**: 开发一个简单的Web后台，方便管理员查看游戏数据、管理玩家及其宝可梦。

